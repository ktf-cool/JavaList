# 快速排序



## 一、基本算法

- 快速排序是一种分治的排序算法。它将一个数组分成两个子数组，将两部分独立地排序，当两个子数组都有序时整个数组也就自然有序了。
- 在快速排序中，切分的位置取决于数组的内容：

![](D:\java笔记\算法总结\images\快速排序过程图.png)

- 快递排序代码实现：

```java
public class Quick {
	public static void sort(Comparable[] a) {
		StdRandom.shuffle(a);    //消除对输入的依赖
		sort(a, 0, a.length - 1);
	}
	private static void sort(Comparable[] a, int lo, int hi) {
		if(hi <= lo)
			return;
		int j = partition(a, lo, hi);  //切分
		sort(a, lo, j - 1);   //将左半部分a[lo..j - 1]排序
		sort(a, j + 1, hi);   //将右半部分a[j + 1..hi]排序
	}
}
```

> 该方法的关键在于切分，满足下面三个条件：

1. 对于某个`j`, `a[j]`已经排定；
2. `a[lo]` 到 `a[j-1]` 中所有元素都不大于`a[j]`;
3. `a[j+1]`到`a[hi]`中的所有元素都不小于`a[j]`;

- 快速排序的切分：

```java
private static int partition(Comparable[] a, int lo, int hi) {
	//将数组切分为a[lo..i-1], a[i], a[i+1..hi]
	int i = lo, j = hi + 1;  //左右扫描指针
	Comparable v = a[lo];   //切分元素
	while(true) {
		//扫描左右， 检查扫描是否结束并交换元素
		while(less(a[++i], v))
			if(i == hi)
				break;
		while(less(v, a[--j]))
			if(j == lo)
				break;
		if(i >= j)
			break;
		exch(a, i, j);
	}
	exch(a, lo, j);  //将 v = a[j] 放入正确的位置
	return j;   //a[lo..j-1] <= a[j] <= a[j+1..hi]达成
}
```

- 切分轨迹：

![](D:\java笔记\算法总结\images\切分轨迹.png)

- 三向切分的快速排序：

```java
public class Quick3way {
	private static void sort(Comparable[] a, int lo, int hi) {
		//调用此方法的公有方法sort()
		if(hi <= lo)
			return;
		int lt = lo, i = lo + 1, gt = hi;
		Comparable v = a[lo];
		while (i <= gt) {
			int cmp = a[i].compareTo(v);
			if(cmp < 0) 
				exch(a, lt++, i++)
			else if (cmp > 0) 
				exch(a, i, gt--);
			else
				i ++;
		}
		//现在a[lo..lt-1] < v = a[lt..gt] < a[gt+1..hi]成立
		sort(a, lo, lt - 1);
		sort(a, gt + 1, hi);
	}
}
```

- 三向切分的轨迹：

![](D:\java笔记\算法总结\images\三向切分的轨迹.png)